{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://tabularis.dev/schemas/plugin-manifest.json",
  "title": "Tabularis Plugin Manifest",
  "description": "Schema for the manifest.json file required by every Tabularis database driver plugin.",
  "type": "object",
  "required": ["id", "name", "version", "executable", "capabilities", "data_types"],
  "additionalProperties": false,
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9-]+$",
      "description": "Unique driver identifier (lowercase letters, digits, hyphens). Must match the plugin folder name."
    },
    "name": {
      "type": "string",
      "description": "Display name shown in the UI (e.g. \"DuckDB\")."
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Plugin version in semver format (e.g. \"1.0.0\")."
    },
    "description": {
      "type": "string",
      "description": "Short description shown in the plugins list."
    },
    "default_port": {
      "type": ["integer", "null"],
      "description": "Default TCP port for the database. Use null for file-based databases."
    },
    "executable": {
      "type": "string",
      "description": "Relative path to the plugin executable inside the plugin folder (without extension on Linux/macOS; Tabularis appends .exe on Windows automatically)."
    },
    "capabilities": {
      "type": "object",
      "description": "Feature flags that control which UI elements Tabularis renders for this driver.",
      "required": ["schemas", "views", "routines", "file_based", "identifier_quote", "alter_primary_key"],
      "additionalProperties": false,
      "properties": {
        "schemas": {
          "type": "boolean",
          "description": "true if the database supports named schemas (e.g. PostgreSQL). Shows the schema selector in the connection UI."
        },
        "views": {
          "type": "boolean",
          "description": "true to enable the Views section in the database explorer."
        },
        "routines": {
          "type": "boolean",
          "description": "true to enable stored procedures and functions in the database explorer."
        },
        "file_based": {
          "type": "boolean",
          "description": "true for local file databases (e.g. SQLite, DuckDB). Replaces the host/port fields with a file path input."
        },
        "folder_based": {
          "type": "boolean",
          "default": false,
          "description": "true for plugins that connect to a directory rather than a single file (e.g. CSV plugin). Replaces host/port fields with a folder picker."
        },
        "identifier_quote": {
          "type": "string",
          "enum": ["\"", "`"],
          "description": "Character used to quote SQL identifiers: double-quote for ANSI SQL, backtick for MySQL-style."
        },
        "alter_primary_key": {
          "type": "boolean",
          "description": "true if the database supports altering primary keys after table creation."
        }
      }
    },
    "data_types": {
      "type": "array",
      "description": "List of SQL data types supported by this driver for column creation in the UI.",
      "items": {
        "type": "object",
        "required": ["name", "category", "requires_length", "requires_precision"],
        "additionalProperties": false,
        "properties": {
          "name": {
            "type": "string",
            "description": "SQL type name as it appears in DDL (e.g. \"VARCHAR\", \"BIGINT\")."
          },
          "category": {
            "type": "string",
            "enum": ["numeric", "string", "date", "binary", "json", "spatial", "other"],
            "description": "UI grouping category for this type."
          },
          "requires_length": {
            "type": "boolean",
            "description": "true if this type requires a length argument (e.g. VARCHAR(255))."
          },
          "requires_precision": {
            "type": "boolean",
            "description": "true if this type requires a precision/scale argument (e.g. DECIMAL(10,2))."
          },
          "default_length": {
            "type": "string",
            "description": "Optional default length value pre-filled in the UI (e.g. \"255\" for VARCHAR)."
          }
        }
      }
    }
  }
}
